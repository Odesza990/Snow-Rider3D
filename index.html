<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Snow Rider 3D - Thrilling Skiing Adventure Game</title>
    <meta name="description" content="Immerse yourself in Snow Rider 3D, a thrilling skiing adventure game set in breathtaking mountain landscapes. Ride your sleigh down snowy slopes, dodge obstacles, and collect gifts for an exhilarating experience.">
    <meta name="theme-color" content="#007ACC">
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Your Name">
    <meta name="keywords" content="Snow Rider 3D, skiing game, winter sports, snowboarding, ski game, mountain landscapes, skiing adventure, snowboarding adventure, snowy mountain, sleigh ride, winter game">
    <script>
        // === 超早期防护：直接禁用 gd-sdk.js 和恶意跳转 ===
        console.log("🛡️ 启动反广告跳转防护...");

        // 1. 完全禁用 window.open
        window.open = function(url) {
            console.warn("🚫 已阻止 window.open 跳转到:", url);
            return {
                focus: function(){}, blur: function(){}, close: function(){},
                closed: false, location: { href: "" }
            };
        };

        // 2. 锁定 window.open
        Object.defineProperty(window, 'open', {
            value: window.open,
            writable: false,
            configurable: false
        });

        // 3. 直接阻止 gd-sdk.js 脚本加载
        const originalCreateElement = document.createElement;
        document.createElement = function(tagName) {
            const element = originalCreateElement.call(this, tagName);
            if (tagName.toLowerCase() === 'script') {
                const originalSetAttribute = element.setAttribute;
                element.setAttribute = function(name, value) {
                    if (name === 'src' && (
                        value.includes('gd-sdk.js') ||
                        value.includes('gameDistribution') ||
                        value.includes('cmug') ||
                        value.includes('gitlab.io')
                    )) {
                        console.warn("🚫 已阻止加载恶意脚本:", value);
                        return; // 不设置 src，阻止加载
                    }
                    return originalSetAttribute.call(this, name, value);
                };
            }
            return element;
        };

        // 4. 创建完整的假 GameDistribution SDK
        window.gdsdk = {
            // 广告相关方法
            showAd: function(type, options) {
                console.warn("🚫 已阻止 GameDistribution 广告显示:", type);
                if (options && options.onStart) options.onStart();
                if (options && options.onComplete) options.onComplete();
                return Promise.resolve();
            },
            preloadAd: function(type) {
                console.warn("🚫 已阻止 GameDistribution 广告预加载:", type);
                return Promise.resolve();
            },
            // 插屏广告对象
            Interstitial: {
                show: function(options) {
                    console.warn("🚫 已阻止插屏广告显示");
                    if (options && options.onStart) options.onStart();
                    if (options && options.onComplete) options.onComplete();
                    return Promise.resolve();
                },
                preload: function() {
                    console.warn("🚫 已阻止插屏广告预加载");
                    return Promise.resolve();
                }
            },
            // 激励广告对象
            Rewarded: {
                show: function(options) {
                    console.warn("🚫 已阻止激励广告显示");
                    if (options && options.onStart) options.onStart();
                    if (options && options.onRewarded) options.onRewarded();
                    if (options && options.onComplete) options.onComplete();
                    return Promise.resolve();
                },
                preload: function() {
                    console.warn("🚫 已阻止激励广告预加载");
                    return Promise.resolve();
                }
            },
            // SDK 初始化和状态
            init: function(options) {
                console.warn("🚫 GameDistribution SDK 初始化被拦截");
                if (options && options.onReady) options.onReady();
                return Promise.resolve();
            },
            ready: true,
            adBlocked: false
        };

        // 5. 全局 SDK 拦截函数
        window.SDK_ShowAd = function(type, callback) {
            console.warn("🚫 已阻止 SDK_ShowAd 调用:", type);
            if (callback) callback();
            return true; // 返回 true 表示广告"成功"显示
        };

        console.log("✅ 反广告跳转防护已激活");
    </script>
    <script src="TemplateData/UnityProgress.js"></script>
    <script src="Build/UnityLoader.js"></script>
    <script>
        // === 正常游戏初始化 ===
        var gameInstance = UnityLoader.instantiate("gameContainer", "Build/SnowRider3D-gd-1.json", {onProgress: UnityProgress,Module:{onRuntimeInitialized: function() {UnityProgress(gameInstance, "complete")}}});
    </script>
</head>
<body style="overflow:hidden;padding:0px;margin:0px;">
    <div class="webgl-content">
        <div id="gameContainer" style="width: 960px; height: 600px; margin: auto"></div>
    </div>
</body>
</html>

